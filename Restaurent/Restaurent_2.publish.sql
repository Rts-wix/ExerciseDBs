/*
Deployment script for Restaurent

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "Restaurent"
:setvar DefaultFilePrefix "Restaurent"
:setvar DefaultDataPath "C:\Program Files\Microsoft SQL Server\MSSQL12.SQLEXPRESS\MSSQL\DATA\"
:setvar DefaultLogPath "C:\Program Files\Microsoft SQL Server\MSSQL12.SQLEXPRESS\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO

IF (DB_ID(N'$(DatabaseName)') IS NOT NULL)
BEGIN
    DECLARE @rc      int,                       -- return code
            @fn      nvarchar(4000),            -- file name for back up
            @dir     nvarchar(4000)             -- backup directory

    EXEC @rc = [master].[dbo].[xp_instance_regread] N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'BackupDirectory', @dir output, 'no_output'
    if (@rc = 0) SELECT @dir = @dir + N'\'

    IF (@dir IS NULL)
    BEGIN 
        EXEC @rc = [master].[dbo].[xp_instance_regread] N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'DefaultData', @dir output, 'no_output'
        if (@rc = 0) SELECT @dir = @dir + N'\'
    END

    IF (@dir IS NULL)
    BEGIN
        EXEC @rc = [master].[dbo].[xp_instance_regread] N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\Setup', N'SQLDataRoot', @dir output, 'no_output'
        if (@rc = 0) SELECT @dir = @dir + N'\Backup\'
    END

    IF (@dir IS NULL)
    BEGIN
        SELECT @dir = N'$(DefaultDataPath)'
    END

    SELECT  @fn = @dir + N'$(DatabaseName)' + N'-' + 
            CONVERT(nchar(8), GETDATE(), 112) + N'-' + 
            RIGHT(N'0' + RTRIM(CONVERT(nchar(2), DATEPART(hh, GETDATE()))), 2) + 
            RIGHT(N'0' + RTRIM(CONVERT(nchar(2), DATEPART(mi, getdate()))), 2) + 
            RIGHT(N'0' + RTRIM(CONVERT(nchar(2), DATEPART(ss, getdate()))), 2) + 
            N'.bak' 
            BACKUP DATABASE [$(DatabaseName)] TO DISK = @fn
END
GO
USE [master];


GO

IF (DB_ID(N'$(DatabaseName)') IS NOT NULL) 
BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE [$(DatabaseName)];
END

GO
PRINT N'Creating $(DatabaseName)...'
GO
CREATE DATABASE [$(DatabaseName)]
    ON 
    PRIMARY(NAME = [$(DatabaseName)], FILENAME = N'$(DefaultDataPath)$(DefaultFilePrefix)_Primary.mdf')
    LOG ON (NAME = [$(DatabaseName)_log], FILENAME = N'$(DefaultLogPath)$(DefaultFilePrefix)_Primary.ldf') COLLATE Danish_Norwegian_CI_AS
GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ANSI_NULLS ON,
                ANSI_PADDING ON,
                ANSI_WARNINGS ON,
                ARITHABORT ON,
                CONCAT_NULL_YIELDS_NULL ON,
                NUMERIC_ROUNDABORT OFF,
                QUOTED_IDENTIFIER ON,
                ANSI_NULL_DEFAULT ON,
                CURSOR_DEFAULT LOCAL,
                RECOVERY FULL,
                CURSOR_CLOSE_ON_COMMIT OFF,
                AUTO_CREATE_STATISTICS ON,
                AUTO_SHRINK OFF,
                AUTO_UPDATE_STATISTICS ON,
                RECURSIVE_TRIGGERS OFF 
            WITH ROLLBACK IMMEDIATE;
        ALTER DATABASE [$(DatabaseName)]
            SET AUTO_CLOSE OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ALLOW_SNAPSHOT_ISOLATION OFF;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET READ_COMMITTED_SNAPSHOT OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET AUTO_UPDATE_STATISTICS_ASYNC OFF,
                PAGE_VERIFY NONE,
                DATE_CORRELATION_OPTIMIZATION OFF,
                DISABLE_BROKER,
                PARAMETERIZATION SIMPLE,
                SUPPLEMENTAL_LOGGING OFF 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF IS_SRVROLEMEMBER(N'sysadmin') = 1
    BEGIN
        IF EXISTS (SELECT 1
                   FROM   [master].[dbo].[sysdatabases]
                   WHERE  [name] = N'$(DatabaseName)')
            BEGIN
                EXECUTE sp_executesql N'ALTER DATABASE [$(DatabaseName)]
    SET TRUSTWORTHY OFF,
        DB_CHAINING OFF 
    WITH ROLLBACK IMMEDIATE';
            END
    END
ELSE
    BEGIN
        PRINT N'The database settings cannot be modified. You must be a SysAdmin to apply these settings.';
    END


GO
IF IS_SRVROLEMEMBER(N'sysadmin') = 1
    BEGIN
        IF EXISTS (SELECT 1
                   FROM   [master].[dbo].[sysdatabases]
                   WHERE  [name] = N'$(DatabaseName)')
            BEGIN
                EXECUTE sp_executesql N'ALTER DATABASE [$(DatabaseName)]
    SET HONOR_BROKER_PRIORITY OFF 
    WITH ROLLBACK IMMEDIATE';
            END
    END
ELSE
    BEGIN
        PRINT N'The database settings cannot be modified. You must be a SysAdmin to apply these settings.';
    END


GO
ALTER DATABASE [$(DatabaseName)]
    SET TARGET_RECOVERY_TIME = 0 SECONDS 
    WITH ROLLBACK IMMEDIATE;


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET FILESTREAM(NON_TRANSACTED_ACCESS = OFF),
                CONTAINMENT = NONE 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET AUTO_CREATE_STATISTICS ON(INCREMENTAL = OFF),
                MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT = OFF,
                DELAYED_DURABILITY = DISABLED 
            WITH ROLLBACK IMMEDIATE;
    END


GO
USE [$(DatabaseName)];


GO
IF fulltextserviceproperty(N'IsFulltextInstalled') = 1
    EXECUTE sp_fulltext_database 'enable';


GO
PRINT N'Creating [dbo].[ads]...';


GO
CREATE TABLE [dbo].[ads] (
    [slogan] VARCHAR (50) NULL
);


GO
PRINT N'Creating [dbo].[ingredients]...';


GO
CREATE TABLE [dbo].[ingredients] (
    [ingredientid] CHAR (5)       NOT NULL,
    [name]         VARCHAR (30)   NOT NULL,
    [unit]         CHAR (10)      NULL,
    [unitprice]    NUMERIC (5, 2) NULL,
    [foodgroup]    CHAR (15)      NULL,
    [inventory]    INT            NULL,
    [vendorid]     CHAR (5)       NULL,
    PRIMARY KEY CLUSTERED ([ingredientid] ASC)
);


GO
PRINT N'Creating [dbo].[items]...';


GO
CREATE TABLE [dbo].[items] (
    [itemid]    CHAR (5)       NOT NULL,
    [name]      VARCHAR (30)   NULL,
    [price]     NUMERIC (5, 2) NULL,
    [dateadded] DATE           NULL,
    PRIMARY KEY CLUSTERED ([itemid] ASC)
);


GO
PRINT N'Creating [dbo].[madewith]...';


GO
CREATE TABLE [dbo].[madewith] (
    [itemid]       CHAR (5) NOT NULL,
    [ingredientid] CHAR (5) NOT NULL,
    [quantity]     INT      NOT NULL,
    PRIMARY KEY CLUSTERED ([itemid] ASC, [ingredientid] ASC)
);


GO
PRINT N'Creating [dbo].[meals]...';


GO
CREATE TABLE [dbo].[meals] (
    [mealid] CHAR (5)  NOT NULL,
    [name]   CHAR (20) NULL,
    PRIMARY KEY CLUSTERED ([mealid] ASC),
    UNIQUE NONCLUSTERED ([name] ASC)
);


GO
PRINT N'Creating [dbo].[orders]...';


GO
CREATE TABLE [dbo].[orders] (
    [ordernumber] INT            NOT NULL,
    [linenumber]  INT            NOT NULL,
    [storeid]     CHAR (5)       NOT NULL,
    [menuitemid]  CHAR (5)       NULL,
    [price]       NUMERIC (5, 2) NULL,
    [time]        DATETIME       NULL,
    PRIMARY KEY CLUSTERED ([storeid] ASC, [ordernumber] ASC, [linenumber] ASC)
);


GO
PRINT N'Creating [dbo].[partof]...';


GO
CREATE TABLE [dbo].[partof] (
    [mealid]   CHAR (5)       NOT NULL,
    [itemid]   CHAR (5)       NOT NULL,
    [quantity] INT            NULL,
    [discount] DECIMAL (2, 2) NULL,
    PRIMARY KEY CLUSTERED ([mealid] ASC, [itemid] ASC)
);


GO
PRINT N'Creating [dbo].[stores]...';


GO
CREATE TABLE [dbo].[stores] (
    [storeid] CHAR (5)     NOT NULL,
    [address] VARCHAR (30) NULL,
    [city]    VARCHAR (20) NULL,
    [state]   CHAR (2)     NULL,
    [zip]     CHAR (10)    NULL,
    [manager] VARCHAR (30) NULL,
    PRIMARY KEY CLUSTERED ([storeid] ASC)
);


GO
PRINT N'Creating [dbo].[vendors]...';


GO
CREATE TABLE [dbo].[vendors] (
    [vendorid]    CHAR (5)     NOT NULL,
    [companyname] VARCHAR (30) NOT NULL,
    [repfname]    VARCHAR (20) NULL,
    [replname]    VARCHAR (20) NULL,
    [referredby]  CHAR (5)     NULL,
    PRIMARY KEY CLUSTERED ([vendorid] ASC),
    UNIQUE NONCLUSTERED ([repfname] ASC, [replname] ASC)
);


GO
PRINT N'Creating unnamed constraint on [dbo].[ingredients]...';


GO
ALTER TABLE [dbo].[ingredients]
    ADD DEFAULT ((0)) FOR [inventory];


GO
PRINT N'Creating unnamed constraint on [dbo].[items]...';


GO
ALTER TABLE [dbo].[items]
    ADD DEFAULT (getdate()) FOR [dateadded];


GO
PRINT N'Creating unnamed constraint on [dbo].[madewith]...';


GO
ALTER TABLE [dbo].[madewith]
    ADD DEFAULT ((0)) FOR [quantity];


GO
PRINT N'Creating unnamed constraint on [dbo].[partof]...';


GO
ALTER TABLE [dbo].[partof]
    ADD DEFAULT ((0.00)) FOR [discount];


GO
PRINT N'Creating unnamed constraint on [dbo].[vendors]...';


GO
ALTER TABLE [dbo].[vendors]
    ADD DEFAULT ('SECRET') FOR [companyname];


GO
PRINT N'Creating unnamed constraint on [dbo].[vendors]...';


GO
ALTER TABLE [dbo].[vendors]
    ADD DEFAULT ('Mr. or Ms.') FOR [repfname];


GO
PRINT N'Creating unnamed constraint on [dbo].[ingredients]...';


GO
ALTER TABLE [dbo].[ingredients]
    ADD FOREIGN KEY ([vendorid]) REFERENCES [dbo].[vendors] ([vendorid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[madewith]...';


GO
ALTER TABLE [dbo].[madewith]
    ADD FOREIGN KEY ([ingredientid]) REFERENCES [dbo].[ingredients] ([ingredientid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[madewith]...';


GO
ALTER TABLE [dbo].[madewith]
    ADD FOREIGN KEY ([itemid]) REFERENCES [dbo].[items] ([itemid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[orders]...';


GO
ALTER TABLE [dbo].[orders]
    ADD FOREIGN KEY ([storeid]) REFERENCES [dbo].[stores] ([storeid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[partof]...';


GO
ALTER TABLE [dbo].[partof]
    ADD FOREIGN KEY ([itemid]) REFERENCES [dbo].[items] ([itemid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[partof]...';


GO
ALTER TABLE [dbo].[partof]
    ADD FOREIGN KEY ([mealid]) REFERENCES [dbo].[meals] ([mealid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[vendors]...';


GO
ALTER TABLE [dbo].[vendors]
    ADD FOREIGN KEY ([referredby]) REFERENCES [dbo].[vendors] ([vendorid]);


GO
PRINT N'Creating unnamed constraint on [dbo].[ingredients]...';


GO
ALTER TABLE [dbo].[ingredients]
    ADD CHECK ([foodgroup]='Vegetable' OR [foodgroup]='Fruit' OR [foodgroup]='Bread' OR [foodgroup]='Meat' OR [foodgroup]='Milk');


GO
PRINT N'Creating unnamed constraint on [dbo].[ingredients]...';


GO
ALTER TABLE [dbo].[ingredients]
    ADD CHECK ([unitprice]*[inventory]<=(4000));


GO
PRINT N'Creating [dbo].[menuitems]...';


GO
CREATE VIEW menuitems AS
(SELECT m.mealid AS menuitemid, m.name, CAST(SUM(price * (1 - discount)) AS NUMERIC(5,2)) AS price
 FROM meals m LEFT OUTER JOIN partof p ON m.mealid = p.mealid
              LEFT OUTER JOIN items i ON p.itemid = i.itemid
 GROUP BY m.mealid, m.name)
UNION
(SELECT itemid, name, price
 FROM items);
GO
/*
This script was created by Visual Studio on 13-02-2015 at 01:35.
Run this script on SM-MBP\SQLEXPRESS.Restaurent (sm-MBP\sm) to make it the same as SM-MBP\SQLEXPRESS.restaurant (sm-MBP\sm).
This script performs its actions in the following order:
1. Disable foreign-key constraints.
2. Perform DELETE commands. 
3. Perform UPDATE commands.
4. Perform INSERT commands.
5. Re-enable foreign-key constraints.
Please back up your target database before running this script.
*/
SET NUMERIC_ROUNDABORT OFF
GO
SET XACT_ABORT, ANSI_PADDING, ANSI_WARNINGS, CONCAT_NULL_YIELDS_NULL, ARITHABORT, QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
/*Pointer used for text / image updates. This might not be needed, but is declared here just in case*/
DECLARE @pv binary(16)
BEGIN TRANSACTION
ALTER TABLE [dbo].[madewith] DROP CONSTRAINT [FK__madewith__ingred__276EDEB3]
ALTER TABLE [dbo].[madewith] DROP CONSTRAINT [FK__madewith__itemid__286302EC]
ALTER TABLE [dbo].[orders] DROP CONSTRAINT [FK__orders__storeid__29572725]
ALTER TABLE [dbo].[partof] DROP CONSTRAINT [FK__partof__itemid__2A4B4B5E]
ALTER TABLE [dbo].[partof] DROP CONSTRAINT [FK__partof__mealid__2B3F6F97]
ALTER TABLE [dbo].[ingredients] DROP CONSTRAINT [FK__ingredien__vendo__267ABA7A]
ALTER TABLE [dbo].[vendors] DROP CONSTRAINT [FK__vendors__referre__2C3393D0]
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'DNDRY', N'Don''s Dairy', N'Marla', N'Milker', N'VGRUS')
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'EDDRS', N'Ed''s Dressings', N'Sam', N'Sauce', N'FRTFR')
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'FLVCR', N'Flavorful Creams', N'Sherman', N'Sherbert', N'VGRUS')
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'FRTFR', N'"Fruit Eating" Friends', N'Gilbert', N'Grape', N'FLVCR')
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'SPWTR', N'Spring Water Supply', N'Gus', N'Hing', N'EDDRS')
INSERT INTO [dbo].[vendors] ([vendorid], [companyname], [repfname], [replname], [referredby]) VALUES (N'VGRUS', N'Veggies_R_Us', N'Candy', N'Corn', NULL)
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'CHESE', N'Cheese', N'scoop     ', 0.03, N'Milk           ', 150, N'DNDRY')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'CHIKN', N'Chicken', N'strip     ', 0.45, N'Meat           ', 120, N'DNDRY')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'CRUTN', N'Crouton', N'piece     ', 0.01, N'Bread          ', 400, N'EDDRS')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'GRAPE', N'Grape', N'piece     ', 0.01, N'Fruit          ', 300, N'FRTFR')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'LETUS', N'Lettuce', N'bowl      ', 0.01, N'Vegetable      ', 200, N'VGRUS')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'ORNG ', N'Orange', N'slice     ', 0.05, N'Fruit          ', 10, N'FRTFR')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'PICKL', N'Pickle', N'slice     ', 0.04, N'Vegetable      ', 800, N'VGRUS')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'SCTDR', N'Secret Dressing', N'ounce     ', 0.03, NULL, 120, NULL)
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'SODA ', N'Soda', N'glass     ', 0.69, NULL, 5000, N'SPWTR')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'TOMTO', N'Tomato', N'slice     ', 0.03, N'Fruit          ', 15, N'VGRUS')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'WATER', N'Water', N'glass     ', 0.06, NULL, NULL, N'SPWTR')
INSERT INTO [dbo].[ingredients] ([ingredientid], [name], [unit], [unitprice], [foodgroup], [inventory], [vendorid]) VALUES (N'WTRML', N'Watermelon', N'piece     ', 0.02, N'Fruit          ', NULL, N'FRTFR')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'CHKSD', N'Chicken Salad', 2.85, '19981113')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'FRPLT', N'Fruit Plate', 3.99, '20000902')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'FRTSD', N'Fruit Salad', 3.45, '20000506')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'GDNSD', N'Garden Salad', 0.99, '20010302')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'MILSD', N'Millennium Salad', NULL, '20020816')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'SODA ', N'Soda', 0.99, '20030206')
INSERT INTO [dbo].[items] ([itemid], [name], [price], [dateadded]) VALUES (N'WATER', N'Water', 0.00, '20020519')
INSERT INTO [dbo].[partof] ([mealid], [itemid], [quantity], [discount]) VALUES (N'CKSDS', N'CHKSD', 1, 0.02)
INSERT INTO [dbo].[partof] ([mealid], [itemid], [quantity], [discount]) VALUES (N'CKSDS', N'SODA ', 1, 0.10)
INSERT INTO [dbo].[partof] ([mealid], [itemid], [quantity], [discount]) VALUES (N'VGNET', N'FRTSD', 1, 0.01)
INSERT INTO [dbo].[partof] ([mealid], [itemid], [quantity], [discount]) VALUES (N'VGNET', N'GDNSD', 1, 0.03)
INSERT INTO [dbo].[partof] ([mealid], [itemid], [quantity], [discount]) VALUES (N'VGNET', N'WATER', 1, 0.00)
INSERT INTO [dbo].[meals] ([mealid], [name]) VALUES (N'CKSDS', N'Chicken N Suds      ')
INSERT INTO [dbo].[meals] ([mealid], [name]) VALUES (N'VGNET', N'Vegan Eatin''        ')
INSERT INTO [dbo].[stores] ([storeid], [address], [city], [state], [zip], [manager]) VALUES (N'#2STR', N'2222 2nd Ave.', N'Waco', N'TX', N'76798-7356', N'Greg Speegle')
INSERT INTO [dbo].[stores] ([storeid], [address], [city], [state], [zip], [manager]) VALUES (N'CASTR', N'4444 4th Blvd', N'San Francsico', N'CA', N'94101-4150', N'Greg Donahoo')
INSERT INTO [dbo].[stores] ([storeid], [address], [city], [state], [zip], [manager]) VALUES (N'FIRST', N'1111 Main St.', N'Waco', N'TX', N'76798     ', N'Jeff Donahoo')
INSERT INTO [dbo].[stores] ([storeid], [address], [city], [state], [zip], [manager]) VALUES (N'NDSTR', N'3333 3rd St.', N'Fargo', N'ND', N'58106     ', N'Jeff Speegle')
INSERT INTO [dbo].[stores] ([storeid], [address], [city], [state], [zip], [manager]) VALUES (N'NWSTR', NULL, NULL, N'TX', NULL, N'Man Ager')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 1, 1, N'CKSDS', 3.68, '20050126 14:02:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 1, 2, N'CHKSD', 2.85, '20050126 14:02:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 1, 3, N'SODA ', 0.99, '20050126 14:02:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 1, 4, N'GDNSD', 0.99, '20050126 14:02:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 2, 1, N'CHKSD', 2.85, '20050126 14:04:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 2, 2, N'SODA ', 0.99, '20050126 14:04:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 3, 1, N'CHKSD', 2.85, '20050126 14:05:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 3, 2, N'FRPLT', 3.99, '20050126 14:05:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'#2STR', 3, 3, N'GDNSD', 0.99, '20050126 14:06:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 1, 1, N'CHKSD', 2.85, '20050126 14:22:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 1, 2, N'GDNSD', 0.99, '20050126 14:22:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 2, 1, N'SODA ', 0.99, '20050126 14:23:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 2, 2, N'FRTSD', 3.45, '20050126 14:23:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 2, 3, N'SODA ', 0.99, '20050126 14:24:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 2, 4, N'VGNET', 4.38, '20050126 14:24:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 3, 1, N'VGNET', 4.38, '20050126 14:25:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 3, 2, N'FRPLT', 3.99, '20050126 14:25:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 3, 3, N'FRTSD', 3.45, '20050126 14:26:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 3, 4, N'WATER', 0.00, '20050126 14:26:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'CASTR', 3, 5, N'CHKSD', 2.85, '20050126 14:26:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 1, 1, N'FRTSD', 3.45, '20050126 13:46:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 1, 2, N'WATER', 0.00, '20050126 13:46:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 1, 3, N'WATER', 0.00, '20050126 13:46:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 2, 1, N'CHKSD', 2.85, '20050126 13:47:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 3, 1, N'SODA ', 0.99, '20050126 13:49:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 3, 2, N'FRPLT', 3.99, '20050126 13:49:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'FIRST', 3, 3, N'VGNET', 4.38, '20050126 13:49:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 1, 1, N'WATER', 0.00, '20050126 14:14:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 1, 2, N'FRPLT', 3.99, '20050126 14:14:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 2, 1, N'GDNSD', 0.99, '20050126 14:15:34.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 3, 1, N'VGNET', 4.38, '20050126 14:16:49.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 3, 2, N'FRPLT', 3.99, '20050126 14:17:04.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 3, 3, N'FRTSD', 3.45, '20050126 14:17:19.187')
INSERT INTO [dbo].[orders] ([storeid], [ordernumber], [linenumber], [menuitemid], [price], [time]) VALUES (N'NDSTR', 3, 4, N'SODA ', 0.99, '20050126 14:17:34.187')
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'CHKSD', N'CHESE', 2)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'CHKSD', N'CHIKN', 4)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'CHKSD', N'LETUS', 1)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'CHKSD', N'SCTDR', 1)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'CHESE', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'CRUTN', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'GRAPE', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'ORNG ', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'TOMTO', 8)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRPLT', N'WTRML', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRTSD', N'GRAPE', 10)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'FRTSD', N'WTRML', 5)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'GDNSD', N'LETUS', 4)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'GDNSD', N'TOMTO', 8)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'SODA ', N'SODA ', 1)
INSERT INTO [dbo].[madewith] ([itemid], [ingredientid], [quantity]) VALUES (N'WATER', N'WATER', 1)
ALTER TABLE [dbo].[madewith]
    ADD FOREIGN KEY ([ingredientid]) REFERENCES [dbo].[ingredients] ([ingredientid])
ALTER TABLE [dbo].[madewith]
    ADD FOREIGN KEY ([itemid]) REFERENCES [dbo].[items] ([itemid])
ALTER TABLE [dbo].[orders]
    ADD FOREIGN KEY ([storeid]) REFERENCES [dbo].[stores] ([storeid])
ALTER TABLE [dbo].[partof]
    ADD FOREIGN KEY ([itemid]) REFERENCES [dbo].[items] ([itemid])
ALTER TABLE [dbo].[partof]
    ADD FOREIGN KEY ([mealid]) REFERENCES [dbo].[meals] ([mealid])
ALTER TABLE [dbo].[ingredients]
    ADD FOREIGN KEY ([vendorid]) REFERENCES [dbo].[vendors] ([vendorid])
ALTER TABLE [dbo].[vendors]
    ADD FOREIGN KEY ([referredby]) REFERENCES [dbo].[vendors] ([vendorid])
COMMIT TRANSACTION
GO

GO
DECLARE @VarDecimalSupported AS BIT;

SELECT @VarDecimalSupported = 0;

IF ((ServerProperty(N'EngineEdition') = 3)
    AND (((@@microsoftversion / power(2, 24) = 9)
          AND (@@microsoftversion & 0xffff >= 3024))
         OR ((@@microsoftversion / power(2, 24) = 10)
             AND (@@microsoftversion & 0xffff >= 1600))))
    SELECT @VarDecimalSupported = 1;

IF (@VarDecimalSupported > 0)
    BEGIN
        EXECUTE sp_db_vardecimal_storage_format N'$(DatabaseName)', 'ON';
    END


GO
PRINT N'Update complete.';


GO
